# 🚀 Blueprint to Package Generator

Converts JSON blueprints from the **Instruction generation** system into complete **SAP CPI packages** ready for deployment.

## 📋 What This Does

This script takes the JSON blueprints generated by the RAG Prime Instruction Generation system and converts them into complete SAP CPI packages with:

- ✅ **Complete BPMN XML** - Full integration flow definition
- ✅ **Package Structure** - Proper SAP CPI directory structure
- ✅ **Script Files** - Groovy scripts for processing logic
- ✅ **Mapping Files** - Message mappings for data transformation
- ✅ **Configuration Files** - Parameters and metadata
- ✅ **ZIP Package** - Ready for SAP CPI deployment

## 🎯 How to Use

### 1. Basic Usage
```bash
cd "RAG Prime/package generation"
python blueprint_to_package_generator.py
```

### 2. Process Specific Blueprint
```bash
python blueprint_to_package_generator.py 1
```

### 3. Process All Blueprints
```bash
python blueprint_to_package_generator.py 2
```

## 📁 Input Sources

The script automatically finds blueprints from:

1. **`RAG Prime/Instruction generation/Output json/`** - Generated blueprints
2. **`RAG Prime/Instruction generation/sample_perfect_blueprint.json`** - Sample blueprint

## 📦 Output

- **ZIP files** are created in your **Downloads** folder
- **Package names** follow the pattern: `{blueprint_name}_package.zip`
- **Ready for SAP CPI** - Can be directly imported into SAP Integration Suite

## 🔧 What Gets Generated

### Package Structure
```
{package_name}/
├── META-INF/
│   └── MANIFEST.MF
├── src/main/resources/
│   ├── scenarioflows/integrationflow/
│   │   └── {package_name}.iflw
│   ├── script/
│   │   └── *.groovy
│   ├── mapping/
│   │   └── *.mmap
│   ├── parameters.prop
│   └── parameters.propdef
├── .project
└── metainfo.prop
```

### BPMN Components
- **Start Events** - Message start events with HTTP endpoints
- **Service Tasks** - Content modifiers, scripts, request-reply
- **Gateways** - Exclusive gateways for conditional routing
- **End Events** - Message end events
- **Sequence Flows** - Proper component connections

### Asset Files
- **Groovy Scripts** - Processing logic with error handling
- **Message Mappings** - Data transformation definitions
- **Configuration** - Parameters and metadata

## 🎉 Example Output

When you run the script, you'll see:

```
🚀 Blueprint to Package Generator
==================================================
📋 Found 2 blueprint files:
   1. blueprint_20250929_171706.json
   2. sample_perfect_blueprint.json

🚀 Processing blueprint: sample_perfect_blueprint.json
============================================================
📋 Loading blueprint: sample_perfect_blueprint.json
✅ Blueprint loaded successfully
   📦 Package: sync_sap_s4hana_employee_validation
   🔄 Type: sync
   🤖 Components: 4
🏗️ Creating SAP CPI package: sync_sap_s4hana_employee_validation
📝 Generating BPMN XML from blueprint...
📝 Creating asset files from blueprint...
   ✅ Created script: Script_ValidationLogic.groovy
   ✅ Created script: employee_validation.groovy
   ✅ Created mapping: MessageMapping_Transform.mmap
   ✅ Created mapping: s4hana_to_successfactors_employee.mmap
📁 Created 2 script files and 2 mapping files
✅ SAP CPI package created: output\sync_sap_s4hana_employee_validation.zip
📦 Package moved to: C:\Users\theka\Downloads\sample_perfect_blueprint_package.zip
```

## 🔄 Integration with Instruction Generation

This script is designed to work seamlessly with the **RAG Prime Instruction Generation** system:

1. **Generate Blueprint** - Use `generate_blueprint.py` in Instruction generation
2. **Convert to Package** - Use this script to create SAP CPI packages
3. **Deploy** - Import the ZIP file into SAP Integration Suite

## 🛠️ Technical Details

### Component Types Supported
- **ContentModifier/Enricher** - Context setting and property management
- **Script** - Groovy processing with validation logic
- **RequestReply** - External API calls and service integration
- **MessageMapping** - Data transformation and format conversion
- **ExclusiveGateway** - Conditional routing and decision logic

### BPMN Generation
- **Proper XML structure** following SAP CPI standards
- **Component connections** based on blueprint flow sequence
- **Visual diagram elements** for SAP CPI designer
- **Extension elements** with component properties

### Error Handling
- **Graceful fallbacks** for missing components
- **Default scripts** for script components
- **Default mappings** for mapping components
- **Comprehensive logging** throughout the process

## 🚨 Requirements

- **Python 3.8+**
- **JSON blueprint files** from Instruction generation
- **Windows/Linux/Mac** compatible

## 📊 Success Metrics

The script provides detailed feedback:
- ✅ **Components processed** - Number of BPMN components created
- ✅ **Assets created** - Scripts and mappings generated
- ✅ **Package location** - Where the ZIP file was saved
- ✅ **Processing time** - How long the conversion took

## 🎯 Next Steps

After generating packages:

1. **Import to SAP CPI** - Use the ZIP files in SAP Integration Suite
2. **Configure endpoints** - Update connection details
3. **Test integration** - Validate the flow works correctly
4. **Deploy** - Activate the integration flow

## 🔧 Troubleshooting

### No Blueprints Found
- Ensure you have JSON files in `Instruction generation/Output json/`
- Check that the sample blueprint exists

### Encoding Issues
- The script handles Windows console encoding automatically
- If issues persist, run in a UTF-8 compatible terminal

### Package Creation Fails
- Check file permissions in the output directory
- Ensure sufficient disk space for ZIP creation

---

**🎉 Ready to convert your blueprints to SAP CPI packages!**
